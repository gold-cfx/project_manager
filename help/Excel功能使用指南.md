# 科研项目管理系统 - Excel导入导出功能使用指南

## 功能概述

本系统现已支持完整的Excel导入导出功能，包括：

1. **Excel模板下载** - 提供标准化的项目录入模板
2. **批量导入项目** - 从Excel文件批量导入项目数据
3. **Excel导出** - 将查询结果导出为Excel文件
4. **CSV导出** - 保留原有的CSV导出功能

## 功能使用说明

### 1. 下载Excel模板

**位置**：项目登记界面
**操作步骤**：
1. 点击主菜单"项目登记"
2. 在登记界面点击"下载Excel模板"按钮
3. 选择保存位置，系统将生成包含标准格式的Excel模板

**模板内容**：
- 项目信息工作表：包含所有必要字段
- 填写说明工作表：详细说明每个字段的填写要求
- 数据验证：下拉列表选择项目来源、类型、级别、状态等

### 2. 批量导入项目

**位置**：项目登记界面
**操作步骤**：
1. 点击"Excel批量导入"按钮
2. 选择已填写好的Excel文件
3. 系统将自动处理导入，并显示导入结果

**导入规则**：
- 自动检测重复项目（基于项目名称）
- 跳过已存在的项目
- 显示成功导入和失败的项目数量
- 失败项目会显示具体原因

### 3. 导出查询结果

**位置**：项目查询界面
**操作方式**：
- **导出CSV**：点击"导出CSV"按钮，导出为CSV格式
- **导出Excel**：点击"导出Excel"按钮，导出为Excel格式

**导出内容**：
- 仅导出选中的项目
- 包含完整的项目信息
- Excel格式包含格式化和样式

## 字段映射说明

### 项目信息字段
| Excel列名 | 系统字段 | 必填 | 格式要求 |
|-----------|----------|------|----------|
| 项目名称 | project_name | 是 | 不超过255字符 |
| 项目负责人 | leader | 是 | 不超过50字符 |
| 科室 | department | 是 | 不超过50字符 |
| 联系电话 | phone | 是 | 手机号或座机号 |
| 项目来源 | source | 是 | 下拉选择 |
| 项目类型 | type | 是 | 下拉选择 |
| 项目级别 | level | 是 | 下拉选择 |
| 资助经费（万元） | funding_amount | 是 | 数字，保留2位小数 |
| 资助单位 | funding_unit | 是 | 不超过100字符 |
| 立项年度 | approval_year | 是 | 格式：YYYY |
| 项目编号 | project_code | 是 | 不超过50字符 |
| 项目状态 | status | 是 | 下拉选择 |
| 项目开始时间 | start_date | 是 | 格式：YYYY-MM-DD |
| 项目结束时间 | end_date | 是 | 格式：YYYY-MM-DD |
| 备注 | notes | 否 | 不超过500字符 |

## 常见问题解答

### Q1: 导入时提示"缺少必要的列"
**原因**：Excel文件格式不正确或缺少系统要求的列
**解决**：使用系统提供的模板文件重新填写

### Q2: 日期格式错误
**正确格式**：YYYY-MM-DD，如2024-01-15
**Excel设置**：将单元格格式设置为"日期"或"文本"

### Q3: 数字格式错误
**资助经费**：必须为数字，不能包含中文或特殊字符
**示例**：正确：100.50，错误：100万

### Q4: 项目重复检测
**检测标准**：基于项目名称进行重复检测
**处理方式**：重复项目会被跳过，不会覆盖已有数据

### Q5: 导入失败项目查看
**查看方式**：导入完成后，系统会显示详细的失败信息
**常见原因**：格式错误、必填项缺失、数据类型不匹配

## 技术说明

### 支持的文件格式
- **导入**：.xlsx格式（Excel 2007及以上）
- **导出**：.xlsx格式（Excel 2007及以上）
- **CSV**：.csv格式（UTF-8编码）

### 数据量限制
- **单次导入**：建议不超过1000条记录
- **导出限制**：无明确限制，但建议分批导出大量数据

### 编码说明
- **Excel**：UTF-8编码，支持中文
- **CSV**：UTF-8 with BOM，确保Excel正确识别中文

## 最佳实践

### 数据准备建议
1. **使用模板**：始终使用系统提供的模板
2. **数据验证**：导入前检查数据格式
3. **分批导入**：大量数据建议分批导入
4. **备份数据**：导入前备份现有数据

### 格式规范
1. **日期统一**：使用YYYY-MM-DD格式
2. **数字统一**：资助经费使用标准数字格式
3. **文本清理**：去除多余空格和特殊字符
4. **必填完整**：确保所有必填字段都有值

## 技术支持

如遇到技术问题，请检查：
1. 文件格式是否正确
2. 数据格式是否符合要求
3. 系统依赖是否完整
4. 查看控制台错误信息