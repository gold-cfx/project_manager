# 科研项目管理系统 - 完整安装及使用手册

## 📋 手册概览

本手册提供科研项目管理系统从环境准备到日常使用的完整指导，包含MySQL部署、系统安装、初始化配置、用户管理等全流程操作指南。

---

## 🎯 系统要求

### 硬件要求
- **操作系统**: Windows 7/8/10/11 (64位)
- **内存**: 最低4GB，推荐8GB以上
- **硬盘**: 至少2GB可用空间
- **网络**: 局域网或互联网连接（可选）

### 软件依赖
- **MySQL**: 5.7+ 或 8.0+
- **Python**: 3.8+ (开发环境)
- **运行时**: 已打包的可执行文件

---

## 📦 第一步：MySQL数据库部署

### 1.1 MySQL安装

#### Windows系统安装
1. **下载MySQL**
   - 访问官网：https://dev.mysql.com/downloads/installer/
   - 选择MySQL Installer for Windows
   - 下载mysql-installer-community-8.0.xx.msi

2. **运行安装程序**
   ```
   双击 mysql-installer-community-8.0.xx.msi
   选择 "Custom" 自定义安装
   选择 MySQL Server 8.0.x
   选择 MySQL Workbench 8.0.x (可选)
   ```

3. **配置MySQL**
   ```
   配置类型: Development Computer
   端口号: 3306 (默认)
   认证方式: Use Strong Password Encryption
   设置root密码: [设置您的root密码]
   创建用户: [可选创建专用用户]
   ```

#### Linux系统安装（可选）
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install mysql-server mysql-client

# CentOS/RHEL
sudo yum install mysql-server mysql
sudo systemctl start mysqld
sudo systemctl enable mysqld
```

### 1.2 数据库创建与远程配置

#### 1.2.1 基础数据库创建
1. **连接MySQL**
   ```bash
   mysql -u root -p
   ```

2. **创建数据库**
   ```sql
   CREATE DATABASE research_project_db 
   CHARACTER SET utf8mb4 
   COLLATE utf8mb4_unicode_ci;
   
   USE research_project_db;
   ```

3. **创建用户并授权**
   ```sql
   -- 本地访问用户
   CREATE USER 'research_user'@'localhost' IDENTIFIED BY 'research_2024';
   GRANT ALL PRIVILEGES ON research_project_db.* TO 'research_user'@'localhost';
   
   -- 远程访问用户（用于网络部署）
   CREATE USER 'research_user'@'%' IDENTIFIED BY 'research_2024';
   GRANT ALL PRIVILEGES ON research_project_db.* TO 'research_user'@'%';
   FLUSH PRIVILEGES;
   ```

#### 1.2.2 开启远程访问配置

##### Windows系统配置
1. **修改MySQL配置文件**
   ```
   文件路径: C:\ProgramData\MySQL\MySQL Server 8.0\my.ini
   修改内容:
   [mysqld]
   bind-address = 0.0.0.0
   port = 3306
   ```

2. **重启MySQL服务**
   ```bash
   # 管理员命令提示符
   net stop mysql
   net start mysql
   ```

3. **配置Windows防火墙**
   ```bash
   # 方法一：命令行（管理员权限）
   netsh advfirewall firewall add rule name="MySQL3306" dir=in action=allow protocol=TCP localport=3306
   
   # 方法二：图形界面
   控制面板 → Windows Defender防火墙 → 高级设置 → 入站规则 → 新建规则
   → 端口 → TCP → 3306 → 允许连接 → 应用所有配置文件 → 命名"MySQL3306"
   ```

##### Linux系统配置
```bash
# Ubuntu/Debian
sudo nano /etc/mysql/mysql.conf.d/mysqld.cnf
# 修改: bind-address = 0.0.0.0

sudo ufw allow 3306/tcp
sudo systemctl restart mysql
```

#### 1.2.3 网络环境检查
1. **测试端口连通性**
   ```bash
   # 在客户端机器上测试
   telnet [服务器IP] 3306
   # 或
   nc -zv [服务器IP] 3306
   ```

2. **验证远程连接**
   ```bash
   mysql -h [服务器IP] -u research_user -p
   ```

---

## 🚀 第二步：系统软件安装

### 2.1 系统文件结构

#### 2.1.1 安装模式说明

##### 🏢 管理员模式（完整安装）
适合：系统管理员、IT管理人员
- 需要：安装MySQL数据库
- 权限：完整系统管理权限
- 用途：系统初始化、用户管理、数据维护

##### 👥 普通用户模式（客户端使用）
适合：普通用户、部门人员
- 无需：安装数据库
- 需要：管理员提供连接信息
- 权限：根据角色分配的权限

##### 📁 系统文件结构
```
科研项目管理系统/
├── 科研项目管理系统.exe      # 主程序
├── config/                   # 配置文件目录
│   ├── config.json          # 数据库配置
│   └── reminder_config.json # 提醒配置
├── docs/                    # 文档目录
├── help/                    # 帮助文档
├── logs/                    # 日志文件
└── data/                    # 数据文件
```

### 2.2 安装步骤

#### 2.2.1 管理员配置流程

1. **解压软件包**
   ```
   将压缩包解压到指定目录，如：C:\ResearchProject
   建议路径：C:\Program Files\ResearchProject
   ```

2. **配置防火墙**
   ```
   允许科研项目管理系统.exe通过防火墙
   允许端口3306（MySQL）通信（如需要）
   ```

3. **创建快捷方式**
   ```
   右键 科研项目管理系统.exe → 发送到 → 桌面快捷方式
   ```

#### 2.2.2 普通用户配置流程

##### 📋 获取连接信息
从管理员处获取以下信息：
- **服务器IP地址**: 如 192.168.1.100
- **数据库端口**: 通常是3306
- **数据库名称**: research_project_db
- **用户名**: 管理员分配的用户名
- **密码**: 管理员分配的密码

##### 🔧 客户端配置
1. **启动程序**
   - 双击 `科研项目管理系统.exe`
   - 首次运行会弹出数据库配置窗口

2. **填写连接信息**
   ```
   主机: [管理员提供的IP地址]
   端口: 3306
   数据库: research_project_db
   用户名: [管理员分配的用户名]
   密码: [管理员分配的密码]
   ```

3. **测试连接**
   - 点击"测试连接"按钮
   - 显示"连接成功"后点击"保存配置"

##### 📱 多客户端部署
管理员完成配置后，普通用户只需：
1. 复制软件包到本地
2. 输入管理员提供的连接信息
3. 即可直接使用系统

**注意**: 无需重复安装MySQL数据库

---

## ⚙️ 第三步：系统初始化配置

### 3.1 首次启动配置

#### 3.1.1 启动系统
1. **双击桌面图标**启动软件
2. **首次启动**会看到登录界面

#### 3.1.2 隐藏用户登录
1. **使用隐藏用户登录**
   ```
   用户名: cfx
   密码: 1234567890
   ```
   > ⚠️ 注意：隐藏用户仅用于系统初始化配置

### 3.2 数据库配置

#### 3.2.1 进入系统管理
1. 登录后点击顶部菜单：**系统管理 → 数据库配置**

#### 3.2.2 配置数据库连接
```
数据库配置界面：
┌─────────────────────────────────────┐
│ 数据库配置                          │
├─────────────────────────────────────┤
│ 主机地址: localhost                 │
│ 端口号: 3306                        │
│ 数据库名: research_project_db        │
│ 用户名: research_user               │
│ 密码: [输入数据库密码]              │
│ 字符集: utf8mb4                    │
├─────────────────────────────────────┤
│ [测试连接] [保存配置] [重置]        │
└─────────────────────────────────────┘
```

#### 3.2.3 测试数据库连接
1. 点击**测试连接**按钮
2. 等待连接测试结果
3. **成功提示**："数据库连接成功！"
4. **失败处理**：
   - 检查MySQL服务是否启动
   - 验证用户名密码是否正确
   - 确认防火墙端口是否开放

### 3.3 数据库初始化

#### 3.3.1 自动初始化
1. 点击**初始化数据库**按钮
2. 系统会自动：
   - 创建所有数据表
   - 设置表间关系
   - 插入基础数据字典
   - 创建默认管理员账户

#### 3.3.2 初始化完成确认
```
初始化成功提示：
✅ 数据库表创建完成
✅ 数据字典初始化完成
✅ 管理员账户创建完成
✅ 系统配置初始化完成

管理员账户：
用户名: admin
密码: 12345678
```

#### 3.3.3 验证初始化
1. **查看数据表**
   ```sql
   USE research_project_db;
   SHOW TABLES;
   ```

2. **验证管理员用户**
   ```sql
   SELECT * FROM users WHERE username='admin';
   ```

---

## 🔐 第四步：管理员登录与配置

### 4.1 管理员首次登录

#### 4.1.1 退出隐藏用户
1. 点击右上角**退出登录**
2. 返回登录界面

#### 4.1.2 管理员登录
```
登录界面：
┌─────────────────────┐
│ 科研项目管理系统    │
├─────────────────────┤
│ 用户名: [admin]     │
│ 密码: [12345678]    │
│                     │
│ [登录] [忘记密码]   │
└─────────────────────┘
```

#### 4.1.3 修改管理员密码
1. 登录后点击右上角**用户头像**
2. 选择**修改密码**
3. 输入新密码（建议8位以上，包含大小写和数字）

### 4.2 系统基础配置

#### 4.2.1 系统设置
进入：**系统管理 → 系统设置**

```
系统配置界面：
┌─────────────────────────────────────┐
│ 系统设置                          │
├─────────────────────────────────────┤
│ 系统名称: 科研项目管理系统        │
│ 版本号: v1.0.0                     │
│ 文件服务器:                         │
│   主机: localhost                   │
│   端口: 8000                        │
│   存储路径: C:\ResearchFiles        │
│                                     │
│ [保存设置] [恢复默认]               │
└─────────────────────────────────────┘
```

#### 4.2.2 数据字典配置
进入：**系统管理 → 数据字典**

**可配置的字典类型：**
- 项目来源：国家级、省部级、校级、企业合作
- 项目类型：基础研究、应用研究、开发研究、政策研究
- 项目级别：重大项目、重点项目、一般项目、青年项目
- 项目状态：进行中、已完成、已终止、延期

---

## 👥 第五步：用户管理与权限分配

### 5.1 创建用户角色

#### 5.1.1 角色类型
- **运维管理员**：系统配置权限
- **管理员**：所有权限
- **普通用户**：查看权限

#### 5.1.2 添加新用户
1. 进入：**用户管理 → 用户列表**
2. 点击**新增用户**

```
新增用户界面：
┌─────────────────────────────────────┐
│ 新增用户                          │
├─────────────────────────────────────┤
│ 用户名: [必填，唯一]               │
│ 真实姓名: [必填]                   │
│ 密码: [必填，8位以上]              │
│ 确认密码: [必填]                   │
│ 邮箱: [选填]                       │
│ 电话: [选填]                       │
│ 角色: [下拉选择]                   │
│ 状态: [启用/禁用]                   │
├─────────────────────────────────────┤
│ [保存] [取消]                       │
└─────────────────────────────────────┘
```

### 5.2 权限管理

#### 5.2.1 权限清单
| 权限模块 | 运维管理员 |管理员 | 普通用户 |
|----------|----|-------|-------|
| 系统配置 | ✓ | ✓ | ✓ |
| 用户管理 | ✗ | ✓ | ✗ |
| 项目登记 | ✗ | ✓ | ✓ |
| 项目查询 | ✗ | ✓ | ✓ |
| 项目编辑 | ✗ | ✓ | ✓ |
| 项目删除 | ✗ | ✓ | ✗ |
| 数据导出 | ✗ | ✓ | ✓ |
| 提醒管理 | ✗ | ✓ | ✓ |

#### 5.2.2 批量用户导入
1. 准备Excel模板：`用户导入模板.xlsx`
2. 填写用户信息：用户名、真实姓名、部门、角色
3. 上传Excel文件
4. 系统自动创建用户并发送初始密码

---

## 📊 第六步：日常功能使用

### 6.1 项目登记

#### 6.1.1 单个项目登记
1. 进入：**项目管理 → 项目登记**
2. 填写项目信息：

```
项目登记界面：
┌─────────────────────────────────────┐
│ 项目登记                          │
├─────────────────────────────────────┤
│ 基本信息：                          │
│   项目名称: [必填]                 │
│   项目负责人: [必填]                │
│   所属部门: [下拉选择]               │
│   联系电话: [必填]                 │
│                                     │
│ 项目信息：                          │
│   项目来源: [下拉选择]               │
│   项目类型: [下拉选择]               │
│   项目级别: [下拉选择]               │
│   资助金额: [数字，单位万元]         │
│   资助单位: [必填]                  │
│   批准年份: [年份选择]               │
│   项目编号: [必填]                  │
│                                     │
│ 时间安排：                          │
│   开始日期: [日期选择]               │
│   结束日期: [日期选择]               │
│                                     │
│ [保存] [重置] [导入模板]           │
└─────────────────────────────────────┘
```

#### 6.1.2 批量导入
1. 下载模板：`项目录入模板.xlsx`
2. 按模板格式填写多个项目
3. 点击**批量导入**
4. 选择Excel文件上传
5. 系统自动校验并导入数据

### 6.2 项目查询

#### 6.2.1 快速查询
1. 进入：**项目查询 → 快速查询**
2. 输入关键词：项目名称、负责人、部门
3. 点击**搜索**

#### 6.2.2 高级查询
```
高级查询界面：
┌─────────────────────────────────────┐
│ 高级查询                          │
├─────────────────────────────────────┤
│ 查询条件：                          │
│   项目名称: [包含]                 │
│   项目负责人: [等于]                 │
│   所属部门: [下拉选择]               │
│   项目来源: [下拉选择]               │
│   项目类型: [下拉选择]               │
│   项目级别: [下拉选择]               │
│   批准年份: [年份范围]               │
│   开始日期: [日期范围]               │
│   结束日期: [日期范围]               │
│   项目状态: [下拉选择]               │
│                                     │
│ [查询] [重置] [导出Excel]          │
└─────────────────────────────────────┘
```

#### 6.2.3 查询结果操作
- **查看详情**: 点击项目名称
- **编辑项目**: 点击编辑按钮
- **删除项目**: 点击删除按钮（需确认）
- **导出数据**: 导出为Excel或PDF
- **生成图表**: 生成项目统计图表

### 6.3 项目提醒

#### 6.3.1 设置项目提醒
1. 进入：**提醒管理 → 设置提醒**
2. 选择项目：从项目列表选择
3. 设置提醒参数：

```
提醒设置界面：
┌─────────────────────────────────────┐
│ 项目提醒设置                      │
├─────────────────────────────────────┤
│ 选择项目: [下拉选择]                 │
│ 提醒类型:                          │
│   ○ 到期提醒                        │
│   ○ 进度提醒                        │
│   ○ 自定义提醒                      │
│                                     │
│ 提前提醒: [ ] 天                    │
│ 提醒方式:                          │
│   ☑ 弹窗提醒                        │
│   ☑ 邮件提醒                        │
│   ☑ 短信提醒                        │
│                                     │
│ 提醒内容: [自定义内容]               │
│                                     │
│ [保存] [取消]                       │
└─────────────────────────────────────┘
```

#### 6.3.2 提醒管理
- **查看提醒列表**: 显示所有提醒
- **标记已读**: 点击提醒标记为已读
- **编辑提醒**: 修改提醒设置
- **删除提醒**: 取消不需要的提醒

### 6.4 数据统计

#### 6.4.1 统计报表
1. 进入：**统计分析 → 项目统计**
2. 选择统计维度：
   - 按部门统计
   - 按项目类型统计
   - 按项目级别统计
   - 按年份统计

#### 6.4.2 图表生成
- **柱状图**: 项目数量对比
- **饼图**: 项目类型分布
- **折线图**: 历年项目趋势

---

## 📈 第七步：高级功能



### 7.1 系统日志

#### 7.1.1 查看日志
1. 进入：**系统管理 → 系统日志**


---

## 🔧 第八步：故障排除

### 8.1 常见问题

#### 8.1.1 数据库连接失败
**问题表现**："无法连接数据库"
**解决方法**：
1. 检查MySQL服务是否启动
   ```bash
   # Windows
   net start mysql
   
   # Linux
   sudo systemctl start mysql
   ```

2. 检查防火墙设置
3. 验证数据库配置信息
4. 检查用户权限

#### 8.1.2 登录失败
**问题表现**："用户名或密码错误"
**解决方法**：
1. 确认用户名密码正确
2. 检查用户状态是否为启用
3. 重置管理员密码
4. 查看登录日志

#### 8.1.3 文件上传失败
**问题表现**："文件上传失败"
**解决方法**：
1. 检查文件服务器配置
2. 验证存储目录权限
3. 检查文件大小限制
4. 确认网络连接正常

### 8.2 技术支持

#### 8.2.1 联系支持
- **技术支持邮箱**: support@researchproject.com
- **技术支持电话**: 400-123-4567
- **在线客服**: 工作日 9:00-18:00

#### 8.2.2 诊断工具
1. **系统诊断**：生成系统诊断报告
2. **性能监控**：实时监控系统性能
3. **日志分析**：自动分析系统日志

---

## 📋 附录

### A. 默认配置信息

#### A.1 数据库配置
```json
{
  "database": {
    "host": "localhost",
    "port": 3306,
    "database": "research_project_db",
    "username": "research_user",
    "password": "[安装时设置]",
    "charset": "utf8mb4"
  }
}
```

#### A.2 系统配置
```json
{
  "system": {
    "name": "科研项目管理系统",
    "version": "v1.0.0",
    "file_server": {
      "host": "localhost",
      "port": 8000,
      "storage_path": "C:\\ResearchFiles"
    },
    "backup": {
      "enabled": true,
      "frequency": "daily",
      "retention_days": 30
    }
  }
}
```

### B. 快捷键清单

| 快捷键 | 功能说明 |
|--------|----------|
| Ctrl+N | 新建项目 |
| Ctrl+F | 快速查询 |
| Ctrl+E | 导出数据 |
| Ctrl+P | 打印报表 |
| F1     | 帮助文档 |
| F5     | 刷新数据 |

### C. 文件清单

#### C.1 安装文件
- `科研项目管理系统.exe` - 主程序
- `config.json` - 配置文件
- `requirements.txt` - 依赖清单
- `安装及使用手册.md` - 本手册

#### C.2 文档文件
- `数据库结构说明.md` - 数据库文档
- `系统架构图.html` - 系统架构图
- `用户导入模板.xlsx` - 用户导入模板
- `项目录入模板.xlsx` - 项目录入模板

---

## 🎉 使用总结

### 快速开始清单
- [ ] 安装MySQL数据库
- [ ] 创建数据库和用户
- [ ] 启动系统软件
- [ ] 使用隐藏用户配置数据库
- [ ] 初始化数据库
- [ ] 管理员登录并修改密码
- [ ] 创建用户并分配权限
- [ ] 开始正常使用

### 日常维护建议
- 定期备份数据（建议每周）
- 定期更新密码（建议每季度）
- 监控系统日志（建议每月）
- 更新数据字典（根据需要）

---

**文档版本**: v1.0.0  
**更新日期**: 2024-12-01  
**适用版本**: 科研项目管理系统 v1.0.0+