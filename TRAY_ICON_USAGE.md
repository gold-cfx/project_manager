# 系统托盘图标使用说明

## 功能概述
科研项目管理系统现已支持系统托盘图标和任务栏图标功能，统一使用项目中的 `icon/icon.svg` 作为图标，确保界面风格一致。

## 图标特性
- **图标文件**: `icon/icon.svg` (SVG矢量格式) 或 `resources/app_icon.ico` (备用)
- **图标设计**: 蓝色圆形背景，白色"R"字母标识
- **支持功能**: 
  - 任务栏图标：显示统一的项目图标
  - 系统托盘图标：双击显示主窗口、右键菜单操作
  - 窗口图标：标题栏和Alt+Tab切换时显示

## 使用方法

### 1. 启动后自动显示
运行 `python main.py` 后：
- **任务栏图标**：显示为科研项目管理系统图标
- **系统托盘图标**：显示在Windows任务栏右下角
- **窗口图标**：标题栏和Alt+Tab切换时显示相同图标

### 2. 托盘图标操作
- **双击图标**: 显示/恢复主窗口
- **右键点击**: 显示功能菜单
- **鼠标悬停**: 显示"科研项目管理系统"提示

### 3. 托盘菜单功能
右键托盘图标可看到以下菜单项：
- **显示主窗口**: 打开主界面
- **退出**: 完全关闭应用程序

### 4. 窗口关闭行为
点击主窗口关闭按钮时，程序会最小化到系统托盘而不是完全退出。
如需完全退出，请使用托盘图标的"退出"菜单项。

## 图标文件位置
```
office-v3/
├── icon/
│   ├── icon.svg          # 主图标文件（SVG矢量格式）
│   ├── icon.ico          # Windows图标文件
│   └── icon_*.png        # 各尺寸PNG图标
├── resources/
│   └── app_icon.ico      # 备用图标文件
└── ui/
    └── main_window.py    # 图标统一设置实现
```

## 故障排除

### 图标不显示
1. 确认 `icon/icon.svg` 文件存在
2. 检查系统是否支持系统托盘（Windows 7+ 支持）
3. 重启应用程序

### 图标显示异常
1. 检查SVG文件是否完整
2. 尝试使用 `icon/icon.ico` 作为替代
3. 确保PyQt5版本兼容性

## 技术实现
系统托盘功能通过PyQt5的 `QSystemTrayIcon` 类实现，支持：
- 高DPI显示适配
- 多尺寸图标自动缩放
- 右键菜单交互
- 最小化到托盘功能